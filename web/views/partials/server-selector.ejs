<!-- Server Selector -->
<div class="server-selector-container">
    <div class="current-server">
        <% if (selectedGuild.icon) { %>
            <img src="https://cdn.discordapp.com/icons/<%= selectedGuild.id %>/<%= selectedGuild.icon %>.png" 
                 class="server-icon" alt="<%= selectedGuild.name %>">
        <% } else { %>
            <div class="server-icon-placeholder">
                <%= selectedGuild.name.charAt(0).toUpperCase() %>
            </div>
        <% } %>
        <div class="server-details">
            <span class="server-name"><%= selectedGuild.name %></span>
            <span class="server-id"><%= selectedGuild.id %></span>
        </div>
    </div>
    <button class="server-selector-btn" id="serverSelectorBtn">
        <i class="fas fa-chevron-down"></i>
    </button>
    <div class="server-dropdown" id="serverDropdown">
        <% adminGuilds.forEach(guild => { %>
            <a href="/dashboard?guild=<%= guild.id %>" class="server-option <%= guild.id === selectedGuild.id ? 'active' : '' %>">
                <% if (guild.icon) { %>
                    <img src="https://cdn.discordapp.com/icons/<%= guild.id %>/<%= guild.icon %>.png" 
                         class="server-icon" alt="<%= guild.name %>">
                <% } else { %>
                    <div class="server-icon-placeholder">
                        <%= guild.name.charAt(0).toUpperCase() %>
                    </div>
                <% } %>
                <div class="server-info">
                    <span class="server-name"><%= guild.name %></span>
                    <span class="server-id"><%= guild.id %></span>
                </div>
            </a>
        <% }); %>
    </div>
</div>

<script>
    // Dropdown del selector de servidores
    const dropdownToggle = document.getElementById('serverDropdown');
    const dropdownMenu = document.getElementById('serverMenu');

    if (dropdownToggle && dropdownMenu) {
        dropdownToggle.addEventListener('click', (e) => {
            e.stopPropagation();
            dropdownMenu.classList.toggle('show');
        });

        // Cerrar al hacer click fuera
        document.addEventListener('click', (e) => {
            if (!dropdownToggle.contains(e.target) && !dropdownMenu.contains(e.target)) {
                dropdownMenu.classList.remove('show');
            }
        });
    }
</script>
